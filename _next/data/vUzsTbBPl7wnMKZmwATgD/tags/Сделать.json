{"pageProps":{"allPosts":[{"title":"Организуем удалённое рабочее место на машине с linux","date":"2020-06-07T14:15:07.322Z","slug":"remote-workplace-linux","author":{"name":"Roman A. Nosov","picture":"https://avatars3.githubusercontent.com/u/21103635?s=120&v=4","url":"https://github.com/JustAddAcid"},"content":"\nНа фоне эпидемии появилась необходимость в организации удобной удалённой работы на домашнем компьютере с ос *linux* на борту: настроить *rdp* клиент + *skype for business* (*lync*).\n\n### Зачем?\n\nНе все работодатели готовы предоставлять работникам именно *VPN* для доступа к корпоративным сервисам. Лишь открывают RDP-терминал. Видимо, так им кажется безопаснее ¯\\\\_(ツ)_/¯. А также, некоторые вещи физически невозможно развернуть на локальных машинах, так что в некоторых ситуациях протокол удалённых рабочих столов просто необходим.\n\n### Как должно работать в идеале:\n\n1. Нужен настроенный *RDP* клиент с поддержкой *gateways* на linux, который по одному клику открывает рабочий стол удалённой машины.\n2. Нужна возможность созваниваться по skype for business с коллегами без огромных задержек от RDP. В идеале — запуск клиента на локальной машине.\n\n## Добываем себе возможность работать в трусах\n![Удалёнка](/assets/blog/remote-workplace-linux/meme.jpg)\n\n\n### RDP\nВ качестве rdp клиента будем использовать *freerdp* — это один из немногих linux rdp клиентов, который поддерживает шлюзы (gateways). Устанавливаем:\n\n```bash\nsudo apt instal freerdp\n``` \nТеперь запускать удалённые rdp-сеансы мы можем с помощью консольной команды **xfreerdp**. С определенными параметрами:\n\nСо всеми доступными параметрами можно [познакомиться (здесь)](https://github.com/FreeRDP/FreeRDP/wiki/CommandLineInterface \"CommandLineInterface\"). Но нас интересуют вполне конкретные:\n\n1. **/f** — fullscreen mode\n2. **/multimon** — поддержка нескольких мониторов\n3. **/rfx** — \"расширенный\" протокол поверх RDP. \n4. (опционально) **/sound:sys:alsa** — включение стриминга звука на локальную машину\n5. **+clipboard** — расшаривание буфера обмена между удалённым рабочим столом и клиентской машиной\n6. **+fonts** — включить сглаживание шрифтов. \n7. **/v** — хост url\n8. **/d** — домен пользователя,\n9. **/u** — пользователь\n10. **/p** — пароль пользователя\n11. **/g** — шлюз url\n12. **/gd** — домен для авторизации на шлюзе\n13. **/gu** — пользователь для авторизации на шлюзе\n14. **/gp** — пароль для авторизации на шлюзе\n\nИтоговый скрипт запуска у нас будет следующим:\n\n```bash\n#! /bin/bash\n\nxfreerdp /v:targetUrl /d:domain /u:username /p:password /g:gateway /gd:domain /gu:username /gp:password /f /multimon /rfx /sound:sys:alsa +clipboard +fonts\n```\nВсё это можно сохранить в текстовом файле, сделать его исполняемым и положить для удобства на рабочий стол.\n\n```bash\nsudo chmod +x filename #Сделать исполняемым\n```\n\n### Skype for business (lync)\n\nНесмотря на то, что порт обычной (не бизнесовой) версии скайпа  на линукс официально поставляется разработчиками — бизнесовой версии под linux **нет**. Браузерная версия Skype (*Skype web app*) тоже не заведется, т.к. для его функционирования нужно нативное windows-расширение для браузера. Как быть?\n\nВ этом нам поможет прекрасный плагин для мессенджеров — [SIPE](https://sipe.sourceforge.io/ \"A third-party Pidgin plugin for Microsoft LCS/OCS\"). Он позиционирует себя как open-source имплементация протокола OCS, по которому общаются клиенты *Skype for business*.\n\nУстановим pidgin + sipe\n\n```bash\nsudo apt install pidgin pidgin-sipe\n```\n\nПри создании учетных записей выбираем протокол \"Office Communicator\"\n![Pidgin protocols list](/assets/blog/remote-workplace-linux/pidgin-protocols.png)\n\nВводим active directory login/e-mail/пароль. И вуаля! Подключается и работает.\n\nПоскольку, это не официальный клиент, многие (не основные) функции могут отсутствовать. Но базовых более чем хватает:\n\n1. Чат\n2. Звонки, как приватные, так и конференции. \n3. Демонстрация рабочего стола\n4. Совместное использование рабочего стола\n\n#linux #танцы_с_бубном #офисная_боль ","ogImage":{"url":"/assets/blog/remote-workplace-linux/logo.jpg"},"coverImage":"/assets/blog/remote-workplace-linux/logo.jpg","issueId":"9"}],"tag":"Сделать"},"__N_SSG":true}