{"pageProps":{"post":{"title":"Организуем удалённое рабочее место на машине с linux","date":"2020-06-07T14:15:07.322Z","slug":"remote-workplace-linux","author":{"name":"Roman A. Nosov","picture":"/assets/blog/authors/romannosov.png"},"content":"<p>На фоне эпидемии появилась необходимость в организации удобной удалённой работы на домашнем компьютере с ос <em>linux</em> на борту: настроить нормальный <em>rdp</em> клиент + <em>skype for business</em> (<em>lync</em>).</p>\n<h3>Зачем?</h3>\n<p>Не все работодатели готовы предоставлять работникам именно <em>VPN</em> для доступа к корпоративным сервисам. Лишь открывают RDP-терминал. Видимо, так им кажется безопаснее ¯\\<em>(ツ)</em>/¯. Плюс, некоторые вещи физически невозможно развернуть на локальных машинах, так что приходится \"выкручиваться\" протоколом удалённых рабочих столов.</p>\n<h3>Что нужно?</h3>\n<ol>\n<li>Нужен настроенный <em>RDP</em> клиент с поддержкой gateway на linux, который по одному клику открывает рабочий стол удалённой машины.</li>\n<li>Нужна возможность созваниваться по skype for business с коллегами без огромных задержек от RDP. В идеале -- запуск клиента на локальной машине.</li>\n</ol>\n<h2>Добываем себе возможность работать в трусах</h2>\n<p><img src=\"/assets/blog/remote-workplace-linux/meme.jpg\" alt=\"Удалёнка\">)</p>\n<h3>RDP</h3>\n<p>В качестве rdp клиента будем использовать <em>freerdp</em> -- из тех клиентов, что я знаю -- он единственный, который поддерживает шлюзы (gateways). Устанавливаем:</p>\n<pre><code class=\"language-bash\">sudo apt instal freerdp\n</code></pre>\n<p>Теперь запускать удалённые rdp-сеансы мы можем с помощью консольной команды xfreerdp. Определимся с параметрами:\nСо всеми доступными параметрами можно <a href=\"https://github.com/FreeRDP/FreeRDP/wiki/CommandLineInterface\" title=\"CommandLineInterface\">познакомиться здесь</a>. Но нас интересуют вполне конкретные:\n1. <strong>/f</strong> -- fullscreen mode\n2. <strong>/multimon</strong> -- подддержка нескольких мониторов\n3. <strong>/rfx</strong> -- \"расширенный\" протокол поверх RDP.\n4. (опционально) <strong>/sound:sys:alsa</strong> -- вкючение стриминга звука на локальную машину\n5. <strong>+clipboard</strong> -- расшаривание буфера обмена между удалённым рабочим столом и клиентской машиной\n6. <strong>+fonts</strong> -- вкючить сглаживание шрифтов.\n7. <strong>/v</strong> -- хост url\n8. <strong>/d</strong> -- домен пользователя,\n9. <strong>/u</strong> -- пользователь\n10. <strong>/p</strong> -- пароль пользователя\n11. <strong>/g</strong> -- шлюз url\n12. <strong>/gd</strong> -- домен для авторизации на шлюзе\n13. <strong>/gu</strong> -- пользователь для авторизации на шлюзе\n14. <strong>/gp</strong> -- пароль для авторизации на шлюзе</p>\n<p>Итоговый скрипт запуска у нас будет следующим:</p>\n<pre><code class=\"language-bash\">#! /bin/bash\n\nxfreerdp /v:targetUrl /d:domain /u:username /p:password /g:gateway /gd:domain /gu:username /gp:password /f /multimon /rfx /sound:sys:alsa +clipboard +fonts\n</code></pre>\n<p>Всё это можно сохранить в текстовом файле, сделать его <em>executable</em> и положить для удобства на рабочий стол.</p>\n<pre><code class=\"language-bash\">sudo chmod +x filename #Сделать исполняемым\n</code></pre>\n<h3>Skype for business (lync)</h3>\n<p>Несмотря на то, что обычная (не бизнесовая) версия скайпа официально поставляется разработчиками -- бизнесовой версии под linux <strong>нет</strong>. <em>Skype web app</em> тоже не заведется, т.к. для его функционирования нужно нативное windows-расширение для браузера. Как быть?</p>\n<p>В этом нам поможет прекрасный плагин для мессенджеров -- <a href=\"https://sipe.sourceforge.io/\" title=\"A third-party Pidgin plugin for Microsoft LCS/OCS\">SIPE</a>. Он позиционирует себя как open-source имплементация протокола, по которому общаются клиенты <em>Skype for busines</em>.</p>\n<p>Установим pidgin + sipe</p>\n<pre><code class=\"language-bash\">sudo apt install pidgin pidgin-sipe\n</code></pre>\n<p>При создании учетных записей выбираем протокол \"Office Communicator\"\n<img src=\"/assets/blog/remote-workplace-linux/pidgin-protocols.png\" alt=\"Pidgin protocols list\"></p>\n<p>Вводим active directory login/e-mail/пароль. И вуаля! Подключается и работает.</p>\n<p>Поскольку, это не официальный клиент, многие (не основные) функции могут отсутствовать. Но базовых более чем хватает:\n1. Чат\n2. Звонки, как приватные, так и конференции.\n3. Демонстрация рабочего стола\n4. Совместное использование рабочего стола</p>\n","ogImage":{"url":"/assets/blog/remote-workplace-linux/logo.jpg"},"coverImage":"/assets/blog/remote-workplace-linux/logo.jpg","issueId":"9"}},"__N_SSG":true}