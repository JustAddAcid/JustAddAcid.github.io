<!DOCTYPE html><html lang="ru"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="description" content="Nosoff.info — personal blog"/><title>Nosoff.info #танцы_с_бубном</title><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/6a76aa4579e9e08b9326.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6a76aa4579e9e08b9326.css" data-n-g=""/><link rel="preload" href="/_next/static/css/660f735cfd0633f1a2b3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/660f735cfd0633f1a2b3.css" data-n-g=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-6957307470fcc6d1f962.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.9ec1f7868b3e9d138cdd.js" as="script"/><link rel="preload" href="/_next/static/chunks/022a8770.bca366718f045dbe8189.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.cb82874e43d6dd0d0fae.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-934682e3295d5f8e18d6.js" as="script"/><link rel="preload" href="/_next/static/chunks/bc82bb883724fe5faad984d18f20974d5cb6d361.2871a84b50d924fb6d88.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/tags/%5Btag%5D-9ba6a4abdd1821920214.js" as="script"/></head><body><div id="__next"><div class="min-h-screen"><main><div class="container mx-auto px-5"><section class="flex-col md:flex-row flex items-center md:justify-between mt-16 mb-16 md:mb-12"><h1 class="text-6xl md:text-8xl font-bold tracking-tighter leading-tight md:pr-8">Nosoff.info <!-- -->#танцы_с_бубном</h1></section><section><div class="mb-8 md:mb-16"><div class="-mx-5 sm:mx-0"><a aria-label="Авторитарные замашки у проектировщиков интерфейсов TV" href="/posts/authoritarian-tv-interfaces"><img src="/assets/blog/authoritarian-tv-interfaces/background.jpg" alt="Cover Image for Авторитарные замашки у проектировщиков интерфейсов TV" class="shadow-small hover:shadow-medium transition-shadow duration-200"/></a></div></div><div class="md:col-gap-16 lg:col-gap-8 mb-20 md:mb-28"><div><h3 class="screenreader"><a class="hover:underline" href="/posts/authoritarian-tv-interfaces">Авторитарные замашки у проектировщиков интерфейсов TV</a></h3><div class="mb-4 md:mb-0 text-lg"><time dateTime="2020-09-24T13:20:05.316Z">September	24, 2020</time></div></div><div><p class="text-lg leading-relaxed mb-4">Делюсь собственной болью использования LCD-телевизора в качестве монитора на карантине</p><a class="flex items-center" href="https://github.com/JustAddAcid"><img src="https://avatars3.githubusercontent.com/u/21103635?s=120&amp;v=4" class="w-12 h-12 rounded-full mr-4" alt="Roman A. Nosov"/><div class="text-xl font-bold">Roman A. Nosov</div></a></div></div></section><section><h2 class="mb-8 text-6xl md:text-7xl font-bold tracking-tighter leading-tight">More Stories</h2><div class="grid grid-cols-1 md:grid-cols-2 md:col-gap-16 lg:col-gap-32 row-gap-20 md:row-gap-32 mb-32"><div><div class="mb-5"><div class="-mx-5 sm:mx-0"><a aria-label="Экспортируем нужные нам данные из openStreetMap" href="/posts/exporting_data_form_osm"><img src="/assets/blog/exporting_data_form_osm/background.jpg" alt="Cover Image for Экспортируем нужные нам данные из openStreetMap" class="shadow-small hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="screenreader"><a class="hover:underline" href="/posts/exporting_data_form_osm">Экспортируем нужные нам данные из openStreetMap</a></h3><div class="text-lg mb-4"><time dateTime="2020-07-05T14:15:07.322Z">July	5, 2020</time></div><p class="text-lg leading-relaxed mb-4">Иногда возникает ситуация, в которой нам жизненно необходимо получить структурированные геоданные для своих проектов. Можно, конечно, долго собирать данные руками, а можно обратиться к прекрасным открытым базам данных.</p><a class="flex items-center" href="https://github.com/JustAddAcid"><img src="https://avatars3.githubusercontent.com/u/21103635?s=120&amp;v=4" class="w-12 h-12 rounded-full mr-4" alt="Roman A. Nosov"/><div class="text-xl font-bold">Roman A. Nosov</div></a></div><div><div class="mb-5"><div class="-mx-5 sm:mx-0"><a aria-label="Организуем удалённое рабочее место на машине с linux" href="/posts/remote-workplace-linux"><img src="/assets/blog/remote-workplace-linux/logo.jpg" alt="Cover Image for Организуем удалённое рабочее место на машине с linux" class="shadow-small hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="screenreader"><a class="hover:underline" href="/posts/remote-workplace-linux">Организуем удалённое рабочее место на машине с linux</a></h3><div class="text-lg mb-4"><time dateTime="2020-06-07T14:15:07.322Z">June	7, 2020</time></div><p class="text-lg leading-relaxed mb-4">На фоне эпидемии появилась необходимость в организации удобной удалённой работы на домашнем компьютере с ос linux на борту: настроить нормальный rdp клиент + skype for business (lync)</p><a class="flex items-center" href="https://github.com/JustAddAcid"><img src="https://avatars3.githubusercontent.com/u/21103635?s=120&amp;v=4" class="w-12 h-12 rounded-full mr-4" alt="Roman A. Nosov"/><div class="text-xl font-bold">Roman A. Nosov</div></a></div><div><div class="mb-5"><div class="-mx-5 sm:mx-0"><a aria-label="Использование issues в GitHub как движок комментариев" href="/posts/issue-comments-github"><img src="/assets/blog/issue-comments-github/cover.png" alt="Cover Image for Использование issues в GitHub как движок комментариев" class="shadow-small hover:shadow-medium transition-shadow duration-200"/></a></div></div><h3 class="screenreader"><a class="hover:underline" href="/posts/issue-comments-github">Использование issues в GitHub как движок комментариев</a></h3><div class="text-lg mb-4"><time dateTime="2020-05-04T14:15:07.322Z">May	4, 2020</time></div><p class="text-lg leading-relaxed mb-4">Хочу поделиться замечательной идеей: превращения GitHub issues в полноценный движок комментариев для статического блога. Достойная легковесная (и бесплатная!) замена disqus и аналогов.</p><a class="flex items-center" href="https://github.com/JustAddAcid"><img src="https://avatars3.githubusercontent.com/u/21103635?s=120&amp;v=4" class="w-12 h-12 rounded-full mr-4" alt="Roman A. Nosov"/><div class="text-xl font-bold">Roman A. Nosov</div></a></div></div></section></div></main></div><footer class="bg-accent-1 border-t border-accent-2"><div class="container mx-auto px-5"></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"allPosts":[{"title":"Авторитарные замашки у проектировщиков интерфейсов TV","date":"2020-09-24T13:20:05.316Z","slug":"authoritarian-tv-interfaces","author":{"name":"Roman A. Nosov","picture":"https://avatars3.githubusercontent.com/u/21103635?s=120\u0026v=4","url":"https://github.com/JustAddAcid"},"content":"\nМинутка признания. Больше всего в этом мире я ненавижу \"неотключаемые опции\". Есть в этом что-то авторитарное. Когда создатель какой-либо системы играет в бога и заявляет: \"Я просто знаю, что вот эта функция нужна будет всегда. И не отвертитесь! Будете жрать говно до конца!\"\n\nИ такое дерьмо проявляется везде: не только в айтишечке, а даже в обычной жизни! Приведу несколько примеров, чтобы вы поняли, о чем я говорю:\n\n### Интернет в ADSL-эпоху\nВот пришел ты в нулевые года к интернет-провайдеру и говоришь: \"Хочу провести себе тырнет по медному проводу аж **5мб/с**, чтобы смотреть ютуб в 480p и орать с демотиваторов.\"\n\nА тебя заставляют выбирать сразу два тарифа: на интернет и на телефон. Доводы: \"Я не хочу домашний телефон, мне мобилки хватает\" — не работают. И приходится соглашаться с требованиями монополиста — Ростелекома, и платить дополнительный прайс за телефон, которым никто и не воспользовался ни разу. \n\n![Ни единого разрыва](../public/assets/blog/authoritarian-tv-interfaces/without_disconnects.jpg)\n\n### Прекрасное пенсионное и медицинское страхование в рашке\nДля этих штук можно спокойно использовать лозунг \"плати и не пользуйся\". Никого абсолютно не волнует, что человек может просто не дожить до пенсии. Или он самостоятельно хочет накопить себе на старость и не доверяет очень невыгодному вкладу под названием \"пенсионный фонд\", который уже много лет не начисляет проценты. Он просто **не может** отказаться от выплат туда.\n\nС медстраховкой аналогичное дерьмо — ты можешь наблюдаться в частных клиниках за свой счет. **НО** ты **ОБЯЗАН** финансировать безумную и отвратительную систему государственных поликлиник. Зачем? Почему я не могу отказаться выплачивать деньги в фонд, при этом не пользуясь государственной медициной? Потому что какой-то дядька давно решил, что эта опция нужна **всем без исключения** и её нельзя отключить.\n\nИ вот мы подходим к самому главному — юзабилити интерфейсов. И я считаю, что за отсутствие \"выключателя\" у основных функций систем пора уже вводить уголовную ответственность ~~хотя, средневековые развлечения с забиванием камнями тоже подойдут~~ .\n\n## Низкий поклон ребяткам из TOSHIBA\n\nЗадаю вам школьную задачку. **Дано:**\n\n1. Ковидо-карантин, когда закрыты все магазины = 1шт.\n2. Обезьяна, уверенная в том, что она может работать из дома = 1шт.\n3. Ноутбук с экраном 1366x768 = 1шт.\n4. В меру старенький LCD-телевизор TOSHIBA 19AV501 со странным разрешением 1440x900 и возможностью законнектиться по HDMI \n\n![TOSHIBA 19AV501](../public/assets/blog/authoritarian-tv-interfaces/toshiba.jpg)\n\n**Вопрос:** за сколько миллисекунд сгорит стул?\n\n## Суть\n\n![Встал вопрос](../public/assets/blog/authoritarian-tv-interfaces/question.jpg)\n\n~~Во времена моей молодости~~ Когда начался карантин, *встал вопрос* о том, как реализовать своё рабочее место на дому. Мощностью железок я толком не был ограничен, т.к. [подключался по RDP](./remote-workplace-linux) к удалённому компьютеру. Но вот с размером экрана ноутбука у меня возникли проблемы: просто физически не помещались нужные окна на крошечный экран, и постоянно переключаться между окнами было чертовски неудобно. \n\nПоэтому, чтобы хоть как-то сгладить ситуацию, я решил оккупировать ~~Польшу~~ телевизор с кухни и подключить его по *HDMI*. Казалось бы, что может пойти не так в этой ситуации? Берем телевизор, кабель и ноутбук и совмещаем. Но как бы не так! \n\nИменно в момент соития моего ноутбука и телевизора я узнал, ~~откуда взялся оптимус прайм~~ что такое \"неотключаемый оверскан\". **Оверскан** — это когда телевизор увеличивает **всю картинку** на +-5% (при том замыливая), а те куски, которые не влезли на экран — просто отбрасывает, словно их и не было. Т.е. он показывает только середину экрана: без нижней панели с часами и шапок окон сверху.\n\nНаверное, при просмотре каких-то телепередач в этом есть смысл, но при работе за компом це пiздец. А в настройках телевизора нет ничего похожего на отключение этого режима. Совсем ничего. И как с этим жить?\n\n## Поиск информации\n\nВооружившись гуглом и шаманским супер-бубном, я принялся искать инфу об этой проблеме. И что вы думаете? Оказывается, что это говно не связано с конкретной моделью телевизоров. Оверскан у **многих** неотключаемый!\n\nВыходит, это не ошибка разработчиков, а какая-то **устоявшаяся практика**. Я уверен, что существует лобби маньяков-проектировщиков интерфейсов, которые наслаждаются страданиями пользователей по всему миру. Казалось бы, что сложного в добавлении переключателя в меню?\n\n![Маньяки-проектировщики интерфейсов](../public/assets/blog/authoritarian-tv-interfaces/maniac.jpg)\n\n## Попытки решения\n\nСразу после подключения *HDMI* к ноутбуку, телевизор даже не рассказывает о том, что его родное разрешение *1440x900*. И пытается запуститься в дефолтном режиме (1920x1080i).\n\n```bash\n# Ответ xrandr\n\nHDMI-1 connected\n   1920x1080i    50.00 +  60.00    59.94  \n   1280x720      60.00    50.00    59.94  \n   1440x576      50.00  \n   1024x768      75.03    70.07    60.00  \n   1440x480      60.00    59.94  \n   800x600       72.19    75.00    60.32  \n   720x576       50.00  \n   720x576i      50.00  \n   720x480       60.00    59.94  \n   720x480i      60.00    59.94  \n   640x480       75.00    72.81    60.00    59.94  \n\n```\n\nПеребрав все режимы из списка, я увидел, что в режиме 640x480 всё-таки оверскан отключается! То есть, телевизор умеет это делать. Но такое разрешение совсем никуда не годится. Будем копать дальше. \n\nА что будет, если ему насильно объявить родное разрешение?\n\n```bash\ncvt 1440 900 60 # получаем данные для создания режима 1440х900 60 кадров в секунду\n\n\u003e\u003e # 1440x900 59.89 Hz (CVT 1.30MA) hsync: 55.93 kHz; pclk: 106.50 MHz\n\u003e\u003e Modeline \"1440x900_60.00\"  106.50  1440 1528 1672 1904  900 903 909 934 -hsync +vsync\n\nxrandr --newmode \"1440x900_60.00\"  106.50  1440 1528 1672 1904  900 903 909 934 -hsync +vsync\n\nxrandr --addmode HDMI-1 1440x900_60.00 # Добавляем созданный режим к этому подключению\nxrandr --output HDMI-1 --mode 1440x900_60.00 # Запускаем\n```\n\nИ... Ничего! Оверскан продолжает работать. Также на форумах нашел рекомендацию выключить стриминг аудио по HDMI. Казалось бы, при чем здесь оверскан? Но можно попробовать:\n\n```bash\nxrandr --output HDMI-1 --set audio force-dvi\n```\n\nИ опять никакого эффекта. Ни в максимально близком \"стандартном\" режиме (1280x720), ни в \"родном\" разрешении.\n\n### Но выход есть! \n~~в окно~~\n\nПокопавшись в интернете и почти-разочаровавшись в этом мире, я наткнулся на [совершенно отвлеченный сайт](https://zoom.cnews.ru/goods_card/item/1758052/toshiba-19av501), на котором собраны характеристики этой модельки телевизора.\n\nИ там были две очень интересные строки: (Естественно, этой информации не было в официальной инструкции. Потому что страдай.)\n\n[![Скриншот с сайта](../public/assets/blog/authoritarian-tv-interfaces/screenshot.png)](../public/assets/blog/authoritarian-tv-interfaces/screenshot.png)\n\nТам есть разделение на *\"Поддерживаемые форматы входного сигнала\"* и *\"Доступные разрешения при подключении к ПК\"*. Так чем же они отличаются? \n\nКак выяснилось методом тыка — **именно стримингом звука**. Если отключить звук командой, указанной выше, и выставить разрешение из списка *\"Доступные разрешения при подключении к ПК\"*, то телевизор автоматически переходит в режим \"монитора\" и начинает отображать картинку в том же размере, как она отправляется с компьютера. \n\nНо, ЧСХ, среди этого списка \"доступных\" разрешений **НЕТ родного**. Так что, полностью от мыла **избавиться не удастся**. Но это уже кое-что. Затаив лёгкую злобу на разработчиков, выбираем максимальное разрешение из доступных.\n\nИтоговый скрипт запуска этого монитора в нормальном режиме выглядит следующим образом:\n\n```bash\n#! /bin/bash\n\nxrandr --output HDMI-1 --set audio force-dvi\nxrandr --newmode \"1360x768_60.00\"   84.75  1360 1432 1568 1776  768 771 781 798 -hsync +vsync\nxrandr --addmode HDMI-1 1360x768_60.00\nxrandr --output HDMI-1 --mode 1360x768_60.00\n```\n\nЯ его не стал вешать на автозапуск, т.к. иногда подключаю другие устройства по HDMI, и у них со стандартными настройками всё в порядке. Не хотелось бы ломать с ними связь. Так что, я запускаю скрипт после подключения конкретно этого телевизора. \n\n## Финал\n\nЯ очень рад, что основные проблемы разрешились и телевизор заработал в приемлемом режиме. Но длительных танцев с бубном можно было бы **избежать**, если бы переключение с режима **\"телевизора\"** на режим **\"монитора\"** (без оверскана) происходило нормально в меню телевизора, а не отключением стриминга аудио по HDMI. (Что характерно, на windows его вообще не выключить.)\n\nА отсутствие родного разрешения экрана в списке \"поддерживаемых\" — это вообще отдельная шутка инженеров над пользователями. Но с ней можно мириться. \n\nВсех благ\n\n\u003ciframe frameborder=\"0\" style=\"border:none;width:100%;height:180px;\" width=\"100%\" height=\"180\" src=\"https://music.yandex.ru/iframe/#track/63801314/10183597\"\u003eСлушайте \u003ca href='https://music.yandex.ru/album/10183597/track/63801314'\u003eТоталитаризм\u003c/a\u003e — \u003ca href='https://music.yandex.ru/artist/8896777'\u003e808hardcore\u003c/a\u003e на Яндекс.Музыке\u003c/iframe\u003e\n\n#linux #танцы_с_бубном","ogImage":{"url":"/assets/blog/authoritarian-tv-interfaces/background.jpg"},"coverImage":"/assets/blog/authoritarian-tv-interfaces/background.jpg","issueId":"15","excerpt":"Делюсь собственной болью использования LCD-телевизора в качестве монитора на карантине"},{"title":"Экспортируем нужные нам данные из openStreetMap","date":"2020-07-05T14:15:07.322Z","slug":"exporting_data_form_osm","author":{"name":"Roman A. Nosov","picture":"https://avatars3.githubusercontent.com/u/21103635?s=120\u0026v=4","url":"https://github.com/JustAddAcid"},"content":"\nИногда возникает ситуация, в которой нам жизненно необходимо получить структурированные геоданные для своих проектов. Но где их искать? Делать на коленке парсер *google maps*?\n\nНа самом деле нет — всё куда прозаичнее. Их можно без зазрения совести скоммуниздить из прекрасного проекта *openStreetMaps*, попутно дополнив и исправив текущие данные в их базах.\n\n**Краткая справка для тех, кто в танке:** *openStreetMaps* (или кратко *OSM*) — *open source* картографический проект, где каждый пользователь может чуть-чуть дорисовать карту. И по принципу \"с миру по нитке\" собирается свободная и бесплатная карта мира. (как с википедией, только карта)\n\n## Процесс раскулачивания геосервиса запущен\n![Псс, парень, не хочешь немного геоданных?](../public/assets/blog/exporting_data_form_osm/meme.jpg)\n\nИтак, в моём конкретном случае, мне нужно получить данные **по всем железнодорожным станциям России**: название, её код в какой-нибудь международной классификации + координаты. У вас это могут любые другие данные, принцип получения от этого толком не изменяется. \n\nДля вытаскивания небольших данных из *OSM* есть онлайновый инструмент, который позволяет делать запросы и получать результат в *JSON*.\n\nНо лично для меня этот язык запросов выглядит слишком странным + этот инструмент работает до невозможности медленно (а иногда благополучно лежит). [overpass-turbo](https://overpass-turbo.eu/)\n\nНо можно пойти куда **более простым и понятным** путём:\n\n1. Скачать дамп всех данных *OSM* (или маленький кусочек нужной нам территории)\n2. Отфильтровать объекты (оставить только те типы объектов, которые нам нужны)\n3. Преобразовать в формат, который пригоден для загрузки в БД\n\n## Небольшая вставка теории:\nЧтобы придумать, как вытащить железнодорожные станции, нужно понимать, какие данные и с какой структурой там в принципе есть. \n\nЕсть очень хорошая [вводная статья на хабре](https://habr.com/ru/post/146503/).\u003cbr\u003e\nА также имеется [официальная дока](https://wiki.openstreetmap.org/wiki/Map_Features).\n\n**Если кратко:**\n\nДамп данных из *OpenStreetMap* можно представить в виде здоровенного XML файла, который содержит в себе ~~помойку~~ большое скопление тэгов трёх типов:\n\n1. Точки (**node**)\n2. Линии (**way**)\n3. Отношения (**relation**)\n\nВнутри этих тэгов заполняется всякая информация о них в виде **key:value**.\n\n**Например:**\nДавайте попробуем найти в интерфейсе *OSM* любую станцию и посмотреть, что там внутри.\n\nСтанция **Шушары** и её информация (слева в таблице):\n\n![Станция Шушары в интерфейсе](../public/assets/blog/exporting_data_form_osm/shushary.png)\n\nТеперь посмотрим, как она выглядит в данных:\n```xml\n\u003cnode id=\"1377619868\" lat=\"59.8057985\" lon=\"30.3884693\" version=\"9\" timestamp=\"2019-05-08T05:34:15Z\" changeset=\"70007449\" uid=\"474169\" user=\"Yevgeny Gromov\"\u003e\n    \u003ctag k=\"esr:user\" v=\"033004\"/\u003e\n    \u003ctag k=\"name\" v=\"Шушары\"/\u003e\n    \u003ctag k=\"railway\" v=\"station\"/\u003e\n    \u003ctag k=\"uic_ref\" v=\"2005166\"/\u003e\n    \u003ctag k=\"wikidata\" v=\"Q4528146\"/\u003e\n    \u003ctag k=\"wikipedia\" v=\"ru:Шушары (станция)\"/\u003e\n\u003c/node\u003e\n```\n\nДанные хранятся в виде\n```xml\n\u003ctag k=\"key\" v=\"value\"\u003e \n```\nвнутри нашей точки *\"Шушары\"*. А координаты хранятся в атрибутах самого тега \"node\" (lat/lon).\n\nЗамечаем, что признак \"железнодорожная станция\" — это вот такой тэг. На него и будем ориентироваться, когда будем фильтровать данные:\n```xml\n\u003ctag k=\"railway\" v=\"station\"/\u003e\n```\n\nОкей, мы поняли структуру, поняли что нам надо. Но где данные, Лебовски?\n\n![Ваши данные будут храниться здесь](../public/assets/blog/exporting_data_form_osm/meme%20data.jpg)\n\n## Добываем данные\nЕсли у вас достаточно свободного пространства на жестком диске — можете попробовать выкачать весь мир [по официальным инструкциям](https://wiki.openstreetmap.org/wiki/Downloading_data).\n\nЛибо можно зайти на сайт [openStreetMap](https://www.openstreetmap.org/), открыть на карте нужный квадрат и нажать на \"Экспорт\".\n\n### У России другой путь\n**Проблема России в том**, что она достаточно большая, чтобы экспорт в интерфейсе *openStreetMap* **падал** из-за слишком большого количества данных, но всё ещё достаточно маленькая, чтобы ради неё выкачивать весь мир!\n\nСпециально для таких извращенцев, как мы, некоторые люди подготавливают \"нарезку\" мира на удобоваримые куски:\n\n* На [geofabrik.de](https://download.geofabrik.de/) имеются нарезки по континентам\n* На [needgeo.com](https://needgeo.com/) есть данные по странам пост-советского пространства.\n\nПоследняя ссылка как раз нам очень пригодится! :) Выкачиваем оттуда файл RU.pbf (который весит сущие копейки — всего **3GB**)\n\n## Обрабатываем данные\nДля обработки нам понадобятся две консольные утилиты: **osmconvert** и **osmfilter**.\n\nВ *debian/ubuntu* устанавливаются очень просто одной командой:\n```bash\nsudo apt install osmctools\n```\nДля остальных *ОС* имеются ссылки на бинарники на официальной wiki [Osmfilter](https://wiki.openstreetmap.org/wiki/Osmfilter) [Osmconvert](https://wiki.openstreetmap.org/wiki/Osmconvert).\n\nВо-первых, нам нужно распаковать скачанный файл **.pbf** в пригодный для фильтрации формат.\n```bash\nosmconvert RU.pbf -o=RU.o5m\n```\nНа выходе получим файл RU.o5m, который занимает уже 6.2GB. (но это всё ещё бинарный не человеко-читаемый файл.)\n\nТеперь отбрасываем всё лишнее, оставляя только точки с нужным там тегом (который мы нашли в предыдущих параграфах):\n```bash\nosmfilter RU.o5m --keep=\"railway=station\" \u003e stations.osm\n```\nКомпьютер задумается на какое-то время, а затем заполнит файл *stations.osm*. Де-факто, уже почти всё. Мы на выходе получили *XML* файл со всеми нужными нам станциями (3Mb). \n\n**Попробуем проверить данные:**\nОткрываем в любом текстовом редакторе, который способен открывать большие текстовые файлы (vim), и бегло просматриваем станции:\n\nИ тут натыкаемся на станцию метро \"Озерки\". Что ж, формально — это жд, и формально — станция. Но не совсем то, что мне нужно. :)\n\n```xml\n\u003cnode id=\"96459081\" lat=\"60.0354511\" lon=\"30.3210663\" version=\"24\" timestamp=\"2020-01-08T22:53:32Z\" changeset=\"79358758\" uid=\"217225\" user=\"\u0026#38;ergio\"\u003e\n    \u003ctag k=\"colour\" v=\"blue\"/\u003e\n    \u003ctag k=\"layer\" v=\"-5\"/\u003e\n    \u003ctag k=\"name\" v=\"Озерки\"/\u003e\n    \u003ctag k=\"name:de\" v=\"Oserki\"/\u003e\n    \u003ctag k=\"name:en\" v=\"Ozerki\"/\u003e\n    \u003ctag k=\"name:fi\" v=\"Ozerki\"/\u003e\n    \u003ctag k=\"name:ru\" v=\"Озерки\"/\u003e\n    \u003ctag k=\"network\" v=\"Петербургский метрополитен\"/\u003e\n    \u003ctag k=\"operator\" v=\"Петербургский метрополитен\"/\u003e\n    \u003ctag k=\"public_transport\" v=\"station\"/\u003e\n    \u003ctag k=\"railway\" v=\"station\"/\u003e\n    \u003ctag k=\"station\" v=\"subway\"/\u003e\n    \u003ctag k=\"subway\" v=\"yes\"/\u003e\n    \u003ctag k=\"transport\" v=\"subway\"/\u003e\n    \u003ctag k=\"wikidata\" v=\"Q2241386\"/\u003e\n    \u003ctag k=\"wikipedia\" v=\"ru:Озерки (станция метро)\"/\u003e\n\u003c/node\u003e\n```\n\nВидим там целых три тега, которые свидетельствуют о том, что это метро. (зачем такая избыточность?)\n```xml\n\u003ctag k=\"station\" v=\"subway\"/\u003e\n\u003ctag k=\"subway\" v=\"yes\"/\u003e\n\u003ctag k=\"transport\" v=\"subway\"/\u003e\n```\nФильтруем по этим тегам:\n```bash\nosmfilter stations.osm --drop=\"station=subway or subway=yes or transport=subway\" \u003e not_subway.osm\n```\n\nСмотрим на выходной файл — выглядит так, словно успешно отфильтровали. Теперь осталось превратить xml файл в CSV, чтобы удобно залить в базу.\n\nСмотрим на документацию по станциям и составляем список тегов, которые будем выводить в CSV:\n[railway:stations](https://wiki.openstreetmap.org/wiki/RU:Tag:railway%3Dstation)\n\n**Нужные нам столбцы:** \n\n1. id\n2. lat\n3. lon\n4. name\n5. uic_ref — уникальный код железнодорожной станции, присваиваемый UIC (International Union of Railways, Международный союз железных дорог).\n6. esr:user — уникальный код железнодорожной станции в Единой сетевой разметке (ЕСР, для станций Балтики и стран СНГ).\n\nЭкспортируем (обратите внимание, что атрибуты самого *node* записываются через \"@\"):\n```bash\nosmconvert not_subway.osm --all-to-nodes --csv=\"@id @lat @lon name uic_ref esr:user\" --csv=headline \u003e stations.csv\n```\n\nТеперь мы можем со спокойной совестью делать с этими данными, что душе угодно. Можем обрабатывать руками в *EXCEL*, можем залить в базу и использовать в своих разнообразных проектах. \n\nЕсли найдете какие-то неточности в данных, очень рекомендуется исправить их не только у себя, а залить их также на саму *OpenStreetMap*. Так сказать, сделать свой маленький вклад в общее дело. :)\n\n\nP.S. Мистическим образом, под железнодорожные станции ещё мимикрирует Волгоградский метротрам. Но его уже можно отфильтровать в итоговом CSV.\n\n\u003ciframe frameborder=\"0\" style=\"border:none;width:100%;height:180px;\" width=\"100%\" height=\"180\" src=\"https://music.yandex.ru/iframe/#track/31840941/3867842\"\u003eСлушайте \u003ca href='https://music.yandex.ru/album/3867842/track/31840941'\u003eУ трамвая жизнь кривая. норвежская свекла\u003c/a\u003e  —  \u003ca href='https://music.yandex.ru/artist/3976133'\u003eРемонт Воды\u003c/a\u003e на Яндекс.Музыке\u003c/iframe\u003e\n\n[Итоговый CSV файл со станциями здесь.](../public/assets/blog/exporting_data_form_osm/stations.csv)\n\n#танцы_с_бубном #работа_с_данными","ogImage":{"url":"/assets/blog/exporting_data_form_osm/background.jpg"},"coverImage":"/assets/blog/exporting_data_form_osm/background.jpg","issueId":"12","excerpt":"Иногда возникает ситуация, в которой нам жизненно необходимо получить структурированные геоданные для своих проектов. Можно, конечно, долго собирать данные руками, а можно обратиться к прекрасным открытым базам данных."},{"title":"Организуем удалённое рабочее место на машине с linux","date":"2020-06-07T14:15:07.322Z","slug":"remote-workplace-linux","author":{"name":"Roman A. Nosov","picture":"https://avatars3.githubusercontent.com/u/21103635?s=120\u0026v=4","url":"https://github.com/JustAddAcid"},"content":"\nНа фоне эпидемии появилась необходимость в организации удобной удалённой работы на домашнем компьютере с ос *linux* на борту: настроить *rdp* клиент + *skype for business* (*lync*).\n\n### Зачем?\n\nНе все работодатели готовы предоставлять работникам именно *VPN* для доступа к корпоративным сервисам. Лишь открывают RDP-терминал. Видимо, так им кажется безопаснее ¯\\\\_(ツ)_/¯. А также, некоторые вещи физически невозможно развернуть на локальных машинах, так что в некоторых ситуациях протокол удалённых рабочих столов просто необходим.\n\n### Как должно работать в идеале:\n\n1. Нужен настроенный *RDP* клиент с поддержкой *gateways* на linux, который по одному клику открывает рабочий стол удалённой машины.\n2. Нужна возможность созваниваться по skype for business с коллегами без огромных задержек от RDP. В идеале — запуск клиента на локальной машине.\n\n## Добываем себе возможность работать в трусах\n![Удалёнка](../public/assets/blog/remote-workplace-linux/meme.jpg)\n\n\n### RDP\nВ качестве rdp клиента будем использовать *freerdp* — это один из немногих linux rdp клиентов, который поддерживает шлюзы (gateways). Устанавливаем:\n\n```bash\nsudo apt instal freerdp\n``` \nТеперь запускать удалённые rdp-сеансы мы можем с помощью консольной команды **xfreerdp**. С определенными параметрами:\n\nСо всеми доступными параметрами можно [познакомиться (здесь)](https://github.com/FreeRDP/FreeRDP/wiki/CommandLineInterface \"CommandLineInterface\"). Но нас интересуют вполне конкретные:\n\n1. **/f** — fullscreen mode\n2. **/multimon** — поддержка нескольких мониторов\n3. **/rfx** — \"расширенный\" протокол поверх RDP. \n4. (опционально) **/sound:sys:alsa** — включение стриминга звука на локальную машину\n5. **+clipboard** — расшаривание буфера обмена между удалённым рабочим столом и клиентской машиной\n6. **+fonts** — включить сглаживание шрифтов. \n7. **/v** — хост url\n8. **/d** — домен пользователя,\n9. **/u** — пользователь\n10. **/p** — пароль пользователя\n11. **/g** — шлюз url\n12. **/gd** — домен для авторизации на шлюзе\n13. **/gu** — пользователь для авторизации на шлюзе\n14. **/gp** — пароль для авторизации на шлюзе\n\nИтоговый скрипт запуска у нас будет следующим:\n\n```bash\n#! /bin/bash\n\nxfreerdp /v:targetUrl /d:domain /u:username /p:password /g:gateway /gd:domain /gu:username /gp:password /f /multimon /rfx /sound:sys:alsa +clipboard +fonts\n```\nВсё это можно сохранить в текстовом файле, сделать его исполняемым и положить для удобства на рабочий стол.\n\n```bash\nsudo chmod +x filename # Сделать исполняемым\n```\n\n### Skype for business (lync)\n\nНесмотря на то, что порт обычной (не бизнесовой) версии скайпа  на линукс официально поставляется разработчиками — бизнесовой версии под linux **нет**. Браузерная версия Skype (*Skype web app*) тоже не заведется, т.к. для его функционирования нужно нативное windows-расширение для браузера. Как быть?\n\nВ этом нам поможет прекрасный плагин для мессенджеров — [SIPE](https://sipe.sourceforge.io/ \"A third-party Pidgin plugin for Microsoft LCS/OCS\"). Он позиционирует себя как open-source имплементация протокола OCS, по которому общаются клиенты *Skype for business*.\n\nУстановим pidgin + sipe\n\n```bash\nsudo apt install pidgin pidgin-sipe\n```\n\nПри создании учетных записей выбираем протокол \"Office Communicator\"\n![Pidgin protocols list](../public/assets/blog/remote-workplace-linux/pidgin-protocols.png)\n\nВводим active directory login/e-mail/пароль. И вуаля! Подключается и работает.\n\nПоскольку, это не официальный клиент, многие (не основные) функции могут отсутствовать. Но базовых более чем хватает:\n\n1. Чат\n2. Звонки, как приватные, так и конференции. \n3. Демонстрация рабочего стола\n4. Совместное использование рабочего стола\n\n#linux #танцы_с_бубном #офисная_боль ","ogImage":{"url":"/assets/blog/remote-workplace-linux/logo.jpg"},"coverImage":"/assets/blog/remote-workplace-linux/logo.jpg","issueId":"9","excerpt":"На фоне эпидемии появилась необходимость в организации удобной удалённой работы на домашнем компьютере с ос linux на борту: настроить нормальный rdp клиент + skype for business (lync)"},{"title":"Использование issues в GitHub как движок комментариев","date":"2020-05-04T14:15:07.322Z","slug":"issue-comments-github","author":{"name":"Roman A. Nosov","picture":"https://avatars3.githubusercontent.com/u/21103635?s=120\u0026v=4","url":"https://github.com/JustAddAcid"},"content":"\nХочу поделиться замечательной идеей: превращения **GitHub issues** в полноценный движок комментариев для статического блога. Достойная легковесная (и бесплатная!) замена *disqus* и аналогов.\nДля начала, маленькая вводная, с чего всё начиналось:\n\nБыл скучный выходной день во время карантина и я лениво читал интернеты в поисках удобного движка комментариев для своего блога. Я уже был готов поддаться маркетингу disqus'a, но внезапно наткнулся на интересную статью:\n\n(http://donw.io/post/github-comments/)\n\nВ ней автор анализирует трафик своего сайта и приходит к удручающему выводу: *disqus* настолько активно использует трекеры и прочие запросы на сервер, что в примере автора, увеличивал количество XHR-запросов с 16 до 105! Это совершенно неприемлемо. И в качестве альтернативы, рассказчик предлагает переход к ... GitHub Issues! \n\nВ статье прелагается следующая схема:\n\n1. На каждый пост в блоге открывается *issue в GitHub*\n2. Все комментарии создаются непосредственно на сайте *GitHub*\n3. При открытии страницы, клиентский JavaScript код получает все комментарии из issue через *issue API*\n\n## Заводим свой ~~трактор~~ велосипед\n![Возможно всё, но зачем?](../public/assets/blog/issue-comments-github/но_зачем.png)\n\nИ тут я подумал, что раз уж весь мой блог использует *GitHub Pages* в качестве хостинга, то почему бы не попробовать ещё больше интегрироваться в экосистему гитхаба?\n\n### Предварительный алгоритм работы с комментариями (пока я не автоматизировал деплой):\n\n1. Перед созданием поста, руками создаётся issue, оттуда копируется ID и вставляется в .md-темплейт поста.\n2. В исходники страницы добавлен маленький скрипт, который подхватывает этот id страницы и по нему (через Github API получает все комментарии (отрендеренный markdown в html)\n3. Рендер комментариев. \n4. Добавление кнопки \"создать комментарий\", который просто перебрасывает пользователя на страницу GitHub\n\n### Реализация\n\nПоскольку я храню все посты на этом сайте в markdown файлах, мне первым делом нужно запомнить, что при создании файла, в метаданных я теперь буду обязан указывать issue id.\n\n```javascript\n{\n    title: 'Первый пост с использованием markdown и next js'\n    excerpt: 'А заодно и проверка возможности писать на кириллице в этом шаблонизаторе. Если вы читаете этот текст, значит полет нормальный.'\n    coverImage: '/assets/blog/hello-world/завтра_будет_лучше.jpg'\n    date: '2020-05-03T21:00:07.322Z'\n    issueId: '1' // \u003c--- id созданного issue на GitHub\n} \n```\nВ конец страницы с постом добавлен React-компонент Comments, который будет отображать комментарии из ГитХаба. \n\n```html\n    \u003carticle\u003e\n        \u003cComments \n            githubUser=\"JustAddAcid\"\n            githubRepo=\"JustAddAcid.github.io\"\n            issueId={post.issueId} /\u003e\n    \u003c/article\u003e\n```\n\nВнутри компонента **Comments** делаем GET-запрос в https://api.github.com/repos/ ${githubUser}/ ${githubRepo}/issues/ ${issueId}/comments. Например, для комментариев к этой странице, это будет:\n\n(https://api.github.com/repos/ JustAddAcid/JustAddAcid.github.io/ issues/2/comments)\n\n```javascript\ncomponentDidMount() {\n    if (!this.state.data) {\n        const githubUser = this.props.githubUser\n        const githubRepo = this.props.githubRepo\n        const issueId = this.props.issueId\n\n        const that = this;\n        window.fetch(`https://api.github.com/repos/${githubUser}/${githubRepo}/issues/${issueId}/comments`, {\n            headers: {\n                Accept: 'application/vnd.github.v3.html+json'\n            }\n        })\n            .then(response =\u003e response.json())\n            .then(comments =\u003e that.setState({\n                data: comments,\n                isLoading: false\n            }))\n```\n\nНу и красиво рендерим JSON-array, который нам пришел из гитхаба\n\n```javascript\n    render(){\n        // ....\n        {hasData \u0026\u0026 (\n            this.state.data.map(comment =\u003e (\n                \u003cComment\n                    key={comment.id}\n                    avatarUrl={comment.user.avatar_url}\n                    userProfileUrl={comment.user.html_url}\n                    userLogin={comment.user.login}\n                    commentDate={comment.created_at}\n                    commentBody={comment.body_html} /\u003e\n            ))\n        )}\n        \u003cLinkButton text=\"Добавить комментарий\" link={`https://github.com/${githubUser}/${githubRepo}/issues/${issueId}`} /\u003e\n    }\n```\n\nПосле причесывания стилей — получаем достаточно минималистичную и приятную на глаз систему комментариев с поддержкой markdown, цитирования и т.д., которой можно воспользоваться внизу страницы.\n\nЕщё увидимся.\n\n#танцы_с_бубном #javascript ","ogImage":{"url":"/assets/blog/issue-comments-github/cover.png"},"coverImage":"/assets/blog/issue-comments-github/cover.png","issueId":"2","excerpt":"Хочу поделиться замечательной идеей: превращения GitHub issues в полноценный движок комментариев для статического блога. Достойная легковесная (и бесплатная!) замена disqus и аналогов."}],"tag":"танцы_с_бубном"},"__N_SSG":true},"page":"/tags/[tag]","query":{"tag":"танцы_с_бубном"},"buildId":"lLbldybx2HusAO42AZ8wr","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-fa276ba060a4a8ac7eef.js"></script><script src="/_next/static/chunks/main-6957307470fcc6d1f962.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.9ec1f7868b3e9d138cdd.js" async=""></script><script src="/_next/static/chunks/022a8770.bca366718f045dbe8189.js" async=""></script><script src="/_next/static/chunks/commons.cb82874e43d6dd0d0fae.js" async=""></script><script src="/_next/static/chunks/pages/_app-934682e3295d5f8e18d6.js" async=""></script><script src="/_next/static/chunks/bc82bb883724fe5faad984d18f20974d5cb6d361.2871a84b50d924fb6d88.js" async=""></script><script src="/_next/static/chunks/pages/tags/%5Btag%5D-9ba6a4abdd1821920214.js" async=""></script><script src="/_next/static/lLbldybx2HusAO42AZ8wr/_buildManifest.js" async=""></script><script src="/_next/static/lLbldybx2HusAO42AZ8wr/_ssgManifest.js" async=""></script></body></html>